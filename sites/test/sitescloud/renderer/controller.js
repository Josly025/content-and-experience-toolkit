/**
 * Copyright (c) 2019 Oracle and/or its affiliates. All rights reserved.
 * Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl.
 */
"use strict";var SCS=window.SCS||{};SCS.sitePrefix=SCS.sitePrefix||"/",SCS.data={pageId:null,siteInfo:null,structure:null,structurePages:null,basePageModel:null,baseSlotReuseModel:null,pageModel:null,pageLayout:null,mobileLayout:null,navMap:{},navRoot:null,placeholderContent:null,startProgressTimer:null,pageTimeoutTimer:null},SCS.performance={timers:{}},SCS.xmlhttp=new XMLHttpRequest,Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),SCS.initRendering=function(){this.data.startProgressTimer=setTimeout(this.onStartProgress,2500),this.data.pageTimeoutTimer=setTimeout(this.onPageTimeout,3e4),this.setCacheKeys(),this.processSitePrefix(),this.data.pageLocale?this.getLocaleSiteStructure():this.getSiteStructure(this.processSiteStructure)},SCS.isValidLocale=function(e){return-1!==["af","sq","am","ar","ar-DZ","ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-AE","ar-YE","hy","as","az","az-AZ","az-Cyrl-AZ","az-Latn-AZ","eu","be","bn","bs","bg","my","ca","zh","zh-CN","zh-HK","zh-MO","zh-SG","zh-TW","hr","cs","da","dv","nl","nl-BE","nl-NL","en","en-CB","en-AU","en-BZ","en-CA","en-IN","en-IE","en-JM","en-NZ","en-PH","en-ZA","en-TT","en-GB","en-US","et","fo","fi","fr","fr-BE","fr-CA","fr-FR","fr-LU","fr-CH","gl","ka","de","de-AT","de-DE","de-LI","de-LU","de-CH","el","gn","gu","he","hi","hu","is","id","it","it-IT","it-CH","ja","kn","ks","kk","km","ko","lo","la","lv","lt","mk","ms","ms-BN","ms-MY","ml","mt","mi","mr","mn","ne","zxx","no","no-NO","nb","nn","or","pa","fa","pl","pt","pt-BR","pt-PT","rm","ro","ro-MO","ru","ru-MO","sa","gd","gd-IE","sr","sr-SP","sr-RS","sr-Cyrl-RS","sr-Latn-RS","sd","si","sk","sl","so","es","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-VE","sw","sv","sv-FI","sv-SE","tg","ta","tt","te","th","bo","ts","tn","tr","tk","uk","und","ur","uz","uz-UZ","uz-Cyrl-UZ","uz-Latn-UZ","vi","cy","xh","yi","zu"].indexOf(e)||"root"===e},SCS.processSitePrefix=SCS.processSitePrefix||function(e){if(e=e||window.location.pathname,e=decodeURI(e)){e.startsWith("/mobileauthsite/")&&this.sitePrefix.startsWith("/authsite/")&&(this.sitePrefix=this.sitePrefix.replace("/authsite/","/mobileauthsite/"));var t=e.replace(this.sitePrefix,""),s=t&&t.split("/")[0];s&&SCS.isValidLocale(s)&&(this.data.locale=s,"root"!==s&&(this.data.pageLocale=s)),e.startsWith(this.sitePrefix)||e!==this.sitePrefix.substring(0,this.sitePrefix.length-1)&&(this.sitePrefix="/")}},SCS.setCacheKeys=SCS.setCacheKeys||function(e){var t={product:(e=e||window.SCSCacheKeys||{}).product||"",site:e.site||"",theme:e.theme||"",component:e.component||"",caas:e.caas||""};SCS.cacheKeys=t},SCS.onStartProgress=function(){var e=document.getElementById("scsWaitImage");e&&(e.style.display="block")},SCS.onPageTimeout=function(){SCS.clearWaitImage()},SCS.clearWaitImage=function(){var e=document.getElementById("scsWaitImage");e&&(e.style.display="none")},SCS.clearTimers=function(){null!==this.data.pageTimeoutTimer&&(window.clearTimeout(this.data.pageTimeoutTimer),this.data.pageTimeoutTimer=null),null!==this.data.startProgressTimer&&(window.clearTimeout(this.data.startProgressTimer),this.data.startProgressTimer=null)},SCS.onRenderError=function(e){this.clearTimers(),this.clearWaitImage(),this.logError(e)},SCS.logError=function(e){try{e&&window.console&&window.console.error?window.console.error(e):e&&window.console&&window.console.log&&window.console.log(e)}catch(e){}},SCS.parseJson=function(e){var t=null;try{t=JSON.parse(e)}catch(t){throw this.onRenderError("Failed to parse JSON: "+e+" Message: "+t.message),t}return t},SCS.encodeHTML=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return e.replace(/[&"<>'\/]/g,function(e){return t[e]})},SCS.getProductUrl=function(e){var t=!1!==(e=e||{}).useCacheKeys&&SCS.cacheKeys.product?SCS.cacheKeys.product:"",s=t?"/"+SCS.cacheKeys.product:"",r=t?SCS.cacheKeys.product+"/":"",a=e.useSharedUrl?"/_sitesclouddelivery"+s:this.sitePrefix+r+"_sitesclouddelivery";return SCS.sitesCloudCDN&&"string"==typeof SCS.sitesCloudCDN&&!1!==e.useCDN&&(a=SCS.sitesCloudCDN+"/_sitesclouddelivery"),a},SCS.getPageLayout=function(e){if(e){var t=SCS.cacheKeys.theme?SCS.cacheKeys.theme+"/":"",s=SCS.sitePrefix+t+"_themesdelivery/"+encodeURIComponent(this.data.siteInfo.properties.themeName)+"/layouts/"+encodeURIComponent(e);SCS.performance.startTimer("GET layout"),this.callService(s,this.processPageLayout,this.processPageLayout)}else this.onRenderError("A page layout was not specified in the page model.")},SCS.processPageLayout=function(e,t,s){if(s=s||document,SCS.performance.stopTimer("GET layout"),!t||200!=e.status||"string"!=typeof t||t.search(/id=(["'])scsControllerBody\1/g)>=0){var r=this.getErrorPageId();this.data.isRenderingErrorPage||null===r?this.onRenderError("The page layout could not be obtained from the server."):(this.data.isRenderingErrorPage=!0,this.data.pageId=r,this.fetchPageData())}else{t=this.preFillPageLayout(t);for(var a=[{re:/(<!--\$\s*SCS_SITE_HEADER\s*-->)|(\[!--\$\s*SCS_SITE_HEADER\s*--\])/g,src:"siteInfo.properties.header"},{re:/(<!--\$\s*SCS_SITE_FOOTER\s*-->)|(\[!--\$\s*SCS_SITE_FOOTER\s*--\])/g,src:"siteInfo.properties.footer"},{re:/(<!--\$\s*SCS_PAGE_HEADER\s*-->)|(\[!--\$\s*SCS_PAGE_HEADER\s*--\])/g,src:"pageModel.properties.header"},{re:/(<!--\$\s*SCS_PAGE_FOOTER\s*-->)|(\[!--\$\s*SCS_PAGE_FOOTER\s*--\])/g,src:"pageModel.properties.footer"}],i=0;i<a.length;i++){for(var n=a[i].re,o=a[i].src.split("."),c="",l=this.data,S=0;S<o.length-1;S++){if(!l[o[S]]||"object"!=typeof l[o[S]]){l=null;break}l=l[o[S]]}l&&(c="string"==typeof l[o[o.length-1]]?l[o[o.length-1]]:""),t=t.replace(n,c)}var h=SCS.cacheKeys.theme?SCS.cacheKeys.theme+"/":"";SCS.cacheKeys.product&&SCS.cacheKeys.product;t=(t=(t=t.replace(/(["'])\/_sitescloud(\/renderer\/require\.js)/g,"$1"+this.getProductUrl({useCDN:!SCS.useSharedRequireJS&&!SCS.useOriginalRequireJS,useSharedUrl:SCS.useSharedRequireJS})+"$2")).replace(/(["'])\/_sitescloud\//g,"$1"+this.getProductUrl()+"/")).replace(/(["'])\/_themes\//g,"$1"+this.sitePrefix+h+"_themesdelivery/"),t=this.resolveLinks(t),t=this.applySlotReuseData(t);var u=this.getPageModelStyleMarkup();u&&(t=t.replace(/(\s+|>)(<\/head\s*>(?:\s+|<))/i,function(e,t,s){var r=t+u+s;return u="",r}));var p=/(<!--\$\s*SCS_WEB_ANALYTICS_SCRIPT\s*-->)|(\[!--\$\s*SCS_WEB_ANALYTICS_SCRIPT\s*--\])/g,d=this.getWebAnalyticsMarkup()||"",g=!1;t=t.replace(p,function(e,t,s){return g=!0,d}),d&&!g&&(t=t.replace(/(\s+|>)(<\/head\s*>(?:\s+|<))/i,function(e,t,s){return t+d+s})),t=this.injectWyciwygCacheBuster(t),SCS.performance.stopTimer("CONTROLLER"),SCS.performance.startTimer("WriteLayout");var f={siteId:this.data.siteInfo&&this.data.siteInfo.properties&&this.data.siteInfo.properties.siteName?this.data.siteInfo.properties.siteName:null,sitePrefix:this.sitePrefix,pageModel:this.data.pageModel,localePageModel:this.data.localePageModel,pageLanguageCode:this.data.pageLocale,navigationRoot:this.data.navRoot,navigationCurr:this.data.pageId&&"string"==typeof this.data.pageId?parseInt(this.data.pageId):this.data.pageId,structureMap:this.data.navMap,siteInfo:this.data.siteInfo,placeholderContent:this.data.placeholderContent,deviceInfo:SCS.getDeviceInfo(),sitesCloudCDN:"string"==typeof SCS.sitesCloudCDN&&SCS.sitesCloudCDN||"",performance:{timers:SCS.performance.timers},cacheKeys:this.cacheKeys},C=JSON.stringify(f),m="";m+='<script id="scsRenderInfo" type="application/json">',m+=this.encodeHTML(C),m+="<\/script>",m+='\n<script id="scsRenderObject" type="text/javascript">var require = {waitSeconds: 0};<\/script>',m+=u;var y=/(<!--\$\s*SCS_RENDER_INFO\s*-->)|(\[!--\$\s*SCS_RENDER_INFO\s*--\])/g;t=t.replace(y,function(){return m}),this.clearTimers(),this.clearWaitImage(),SCS={},s.open("text/html","replace"),s.write(t),s.close()}},SCS.preFillPageLayout=SCS.preFillPageLayout||function(e){var t,s,r,a,i,n,o,c,l,S,h,u=e,p=this.data.pageModel,d=this.data.localePageModel||{};if(p&&p.componentInstances){i=p.componentInstances;for(S in i)if(i.hasOwnProperty(S)&&"object"==typeof i[S]&&(n=i[S],c=d.componentInstances&&d.componentInstances[S]||{},n&&(o=n.data,l=c.data||{},a="string"==typeof n.type&&0===n.type.indexOf("scs-inline-")))){if(o&&"string"==typeof o.innerHTML){var g=l.innerHTML||o.innerHTML;s=a?"":'<div class="scs-component-bounding-box">',r=a?"":"</div>","string"==typeof(t=this.replaceTagContent(u,S,s+g+r))&&(u=t,n.preRenderedByController=!0)}(h=this.getComponentAttributes(o,l))&&"object"==typeof h&&(u=this.replaceTagAttributes(u,S,h),n.preRenderedByController=!0)}}return u},SCS.getComponentAttributes=function(e,t){var s,r,a,i={},n=t||{};if(e&&"object"==typeof e)for(r in e)"attr_"==r.substring(0,"attr_".length)&&(a=r.substring("attr_".length))&&(i[a]=n[r]||e[r],s=i);return s},SCS.replaceTagAttributes=function(e,t,s){var r,a,i,n,o,c,l,S,h,u=e,p="(<\\w+\\s+)[^>]*[Ii][Dd]=([\"']?)"+t+"\\2(>|[^>]*)>",d={},g="",f="";try{if(e&&t&&Object.keys(s).length>0&&(i=new RegExp(p,"g"),h=i.exec(e))){r=h.index,a=i.lastIndex,S="/"==(n=e.substring(r,a))[n.length-2],o=h[1],c=S?"/>":">",l=n.substring(o.length,n.length-c.length),d=SCS.parseTagAttributes(l);for(f in s)d[f]=s[f];g="";for(f in d)void 0===d[f]?g+=f+" ":g+=f+'="'+d[f]+'" ';u=e.substring(0,r+o.length),u+=g,u+=e.substring(r+o.length+l.length)}}catch(e){SCS.logError("Failed to replace attributes: "+e.message)}return u},SCS.parseTagAttributes=function(e){for(var t={},s="",r="",a="",i="",n=e.length,o=0,c=0;c>=0&&c<n;){for(;c<n&&" "==(a=e.charAt(c));c++);if(c==n)break;for(o=c;c<n&&(" "!=(a=e.charAt(c))&&"="!=a);c++);for(s=e.substr(o,c-o);c<n&&" "==(a=e.charAt(c));c++);if("="==a){for(c+=1;c<n&&" "==(a=e.charAt(c));c++);for("'"==a||'"'==a?(i=a,c+=1):i=" ",o=c;c<n&&(a=e.charAt(c))!=i;c++);r=e.substr(o,c-o),t[s]=r,c++}else t[s]=void 0,o=c}return t},SCS.replaceTagContent=function(e,t,s,r){var a,i,n,o,c,l=null;r=r||{};try{(c=(o=new RegExp("<(\\w+)\\s+[^>]*[Ii][Dd]=([\"']?)"+t+"\\2(>|[^>]*)>","g")).exec(e))&&(c.index,a=o.lastIndex,n=c[1],(i=this.findEndTag(e,n,a))>=0&&(l=e.substring(0,r.append?i:a),l+=s,l+=e.substring(i)))}catch(e){SCS.logError("Failed to replace content: "+e.message)}return l},SCS.findEndTag=function(e,t,s){var r,a,i,n,o=-1;try{if(r=new RegExp("</"+t+"\\s*>","gi"),r.lastIndex=s,a=r.exec(e)){o=a.index,(i=new RegExp("<"+t+"\\s*>","gi")).lastIndex=s;do{if(n=i.exec(e)){if(n.index>o)break;(a=r.exec(e))&&(o=a.index)}}while(n&&a)}}catch(e){SCS.logError("Failed to find end tag: "+e.message)}return o},SCS.injectWyciwygCacheBuster=function(e){var t,s,r=e;return"number"==typeof window.mozInnerScreenX&&(s=/<head(?:\s+[^>]*?)?>/gi.exec(e))&&s[0]&&(t=s.index+s[0].length,r=e.substr(0,t),r+='\n<script type="text/javascript">\n',r+='if( 0 === document.URL.indexOf("wyciwyg://") ) { \n',r+="window.location.replace( window.location.href ); ",r+="}\n<\/script>",r+=e.substr(t)),r},SCS.getPageModelStyleMarkup=function(){var e,t,s,r,a="";try{e=this.data.pageModel.properties.styles,a+=this.getStyleMarkup("scs-styles-body","body",e);for(s in this.data.pageModel.slots)t=this.data.pageModel.slots[s],r=this.data.pageModel.componentInstances,a+=this.getContainerStyleMarkup(s,t,r,!0)}catch(e){a=""}return a.length>0&&(a='\n<style id="scsPageStyles" type="text/css">'+a+"\n</style>"),a},SCS.getContainerStyleMarkup=function(e,t,s,r){var a,i,n,o,c,l,S="";if(t&&(a=t.styles,o=r?"scs-slot-styles-":"scs-container-styles-",c=this.encodeHTML("#"+e)+(r?"":" > .scs-container-styles > .scs-component-content"),S+=this.getStyleMarkup(o+e,c,a),t.components&&Array.isArray(t.components)))for(l=0;l<t.components.length;l++)"object"==typeof s[i=t.components[l]]&&("scs-componentgroup"!==(n=s[i]).type&&"scs-sectionlayout"!==n.type||(S+=this.getContainerStyleMarkup(i,n.data,s,!1)));return S},SCS.getStyleMarkup=function(e,t,s){var r,a,i,n,o,c="";if(Array.isArray(s)&&s.length>0){for(c+="\n"+t+" {",a=0;a<s.length;a++)"string"==typeof(r=s[a])&&(i=r.indexOf(":"))>=0&&(n=r.substring(0,i).trim(),o=r.substring(i+1).trim(),n.indexOf(">")<0&&n.indexOf("<")<0&&o.indexOf(">")<0&&o.indexOf("<")<0&&(c+="\n"+n+": "+(o=this.resolveLinks(o))+";"));c+="\n}"}return c},SCS.getWebAnalyticsMarkup=function(){var e=null,t=this.data.pageModel,s=this.data.siteInfo;return t&&t.properties&&!0===t.properties.overrideWebAnalytics?e=t.properties.webAnalyticsScript:s&&s.properties&&!0===s.properties.isWebAnalyticsEnabled&&(e=s.properties.webAnalyticsScript),e},SCS.applySlotReuseData=function(e){var t=this.getIdentifiedSlotIds(e);return this.fixupPageModelWithSlotReuseData(t.slotIds),t.pageLayout},SCS.getIdentifiedSlotIds=function(e){var t,s,r,a,i,n,o,c=/<!--\s*SCS Layout Information:\s*(\{[\s\S]*?\})\s*-->/;if(e=e.replace(c,function(e,s){try{var r=JSON.parse(s);t=r.slotIds}catch(e){}return""}),!Array.isArray(t)&&(t=[],r=/<\w+\s+[^>]*?[Cc][Ll][Aa][Ss][Ss]\s*=\s*(['"])(?:\s*|[^>'"]*?\s+)scs-slot(?:\s*\1|\s+[^>'"]*?\1)[^>]*?>/g,s=e.match(r)))for(i=/\s+id\s*=\s*(['"])([^'">]+)\1(?:\s+|\/?>)/i,o=0;o<s.length;o++)(a=s[o].match(i))&&(n=a[2])&&t.push(n);return{pageLayout:e,slotIds:t}},SCS.fixupPageModelWithSlotReuseData=function(e){var t,s,r,a,i,n=this.data.pageModel,o=this.data.baseSlotReuseModel;if(o&&e)for(i=0;i<e.length;i++)if(t=e[i],"object"==typeof o[t]&&"object"==typeof o[t].base&&o[t].base.site&&"object"==typeof o[t].base.site&&(s=JSON.parse(JSON.stringify(o[t].base.site)),n.slots[t]=s,s.componentInstances)){for(r in s.componentInstances)a=JSON.parse(JSON.stringify(s.componentInstances[r])),n.componentInstances[r]=a;delete s.componentInstances}},SCS.callService=function(e,t,s){this.xmlhttp.onreadystatechange=function(){if(4==this.readyState){var r;if(200==this.status)r=""+this.responseText,t.call(SCS,this,r);else if(s)r=""+this.responseText,s.call(SCS,this,r);else{try{r=""+this.responseText}catch(e){}SCS.onRenderError("Status "+this.status+" returned from "+e+" with response: "+r)}}},this.xmlhttp.open("GET",e,!0),this.xmlhttp.send()},SCS.resolveLinks=function(e){var t=e;"object"==typeof e&&(t=JSON.stringify(e));for(var s=/(<!--\$\s*SCS_CONTENT_URL\s*-->)|(\[!--\$\s*SCS_CONTENT_URL\s*--\])/g,r=/(<!--\$\s*SCS_COMP_CATALOG_URL\s*-->)|(\[!--\$\s*SCS_COMP_CATALOG_URL\s*--\])/g,a=/(<!--\$\s*SCS_DIST_FOLDER\s*-->)|(\[!--\$\s*SCS_DIST_FOLDER\s*--\])/g,i=/(<!--\$\s*SCS_DIST_IMG_FOLDER\s*-->)|(\[!--\$\s*SCS_DIST_IMG_FOLDER\s*--\])/g,n=/(<!--\$\s*SCS_THEME_NAME\s*-->)|(\[!--\$\s*SCS_THEME_NAME\s*--\])/g,o=/(<!--\$\s*SCS_DESIGN_NAME\s*-->)|(\[!--\$\s*SCS_DESIGN_NAME\s*--\])/g,c=/(<!--\$\s*SCS_RENDERER_PATH\s*-->)|(\[!--\$\s*SCS_RENDERER_PATH\s*--\])/g,l=/(<!--\$\s*SCS_SITE_PATH\s*-->)|(\[!--\$\s*SCS_SITE_PATH\s*--\])/g,S=/\[!--\$\s*SCS_PAGE\s*--\]\s*(.*?)\s*\[\/!--\$\s*SCS_PAGE\s*--\]/g,h=/\[!--\$\s*SCS_DIGITAL_ASSET\s*--\]\s*(.*?)\s*\[\/!--\$\s*SCS_DIGITAL_ASSET\s*--\]/g,u=/\[!--\$\s*SCS_DIGITAL_ASSET_PUBLISHED\s*--\]\s*(.*?)\s*\[\/!--\$\s*SCS_DIGITAL_ASSET_PUBLISHED\s*--\]/g,p=/(_scs_theme_root_)/g,d=/(_scs_design_name_)/g,g=/\[!--\$SCS_TEL--\]*(.*?) *\[\/!--\$SCS_TEL--\]/g,f=/<!--\s*SCS View Mode:([\s\S]*?)-->/g,C=this,m=(SCS.cacheKeys.product&&SCS.cacheKeys.product,SCS.cacheKeys.site?SCS.cacheKeys.site+"/":""),y=SCS.cacheKeys.theme?SCS.cacheKeys.theme+"/":"",P=SCS.cacheKeys.component?SCS.cacheKeys.component+"/":"",I=SCS.cacheKeys.caas?"?cb="+SCS.cacheKeys.caas:"",v=C.data.siteInfo.properties.channelAccessTokens||[],T="",E=0;E<v.length;E++){var b=v[E];if("defaultToken"===b.name){T=(I?"&":"?")+"channelToken="+b.value;break}}var R=C.data.siteInfo.properties.siteRootPrefix,L=(R&&R.indexOf("/authsite/"),function(e){return e.replace(/\/+$/,function(){return""})}),_=function(e){var t=e.split(","),s=t[0].trim(),r=t.length>1?t[1].trim():"",a=t.length>2?t[2].trim():"",i=I||T?"&":"?";return r&&a?s+"/"+r+I+T+i+"format="+a:s+"/native"+I+T};return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(s,function(){return SCS.sitePrefix+m+"content"})).replace(r,function(){return SCS.sitePrefix+P+"_compdelivery"})).replace(a,function(){return SCS.getProductUrl()})).replace(i,function(){return SCS.getProductUrl()+"/renderer"})).replace(c,function(){return SCS.getProductUrl()+"/renderer"})).replace(l,function(){return L(SCS.sitePrefix+m)})).replace(p,function(){return SCS.sitePrefix+y+"_themesdelivery/"+encodeURIComponent(C.data.siteInfo.properties.themeName)})).replace(d,function(){return encodeURIComponent(C.data.siteInfo.properties.designName||"default")})).replace(n,function(){return encodeURIComponent(C.data.siteInfo.properties.themeName)})).replace(o,function(){return encodeURIComponent(C.data.siteInfo.properties.designName||"default")})).replace(S,function(e,t){var s,r=SCS.getPageLinkData(t);return r&&"string"==typeof r.href&&(s=r.href),s})).replace(h,function(e,t){return"/content/published/api/v1.1/assets/"+_(t)}),t=t.replace(u,function(e,t){return"/content/published/api/v1.1/assets/"+_(t)}),t=t.replace(g,function(e,t){return"tel:"+encodeURI(t)}),t=t.replace(f,function(e,t){return t}),"object"==typeof e&&(t=JSON.parse(t)),t},SCS.getPageLinkData=function(e){var t,s,r=!1,a=null,i=this.data.navMap,n="";if(i&&("number"==typeof e||"string"==typeof e&&e)){var o=i[e];if(o){if("string"==typeof o.linkUrl&&o.linkUrl.trim().length>0)t=o.linkUrl.trim(),"string"==typeof o.linkTarget&&(n=o.linkTarget.trim());else if(a=o.pageUrl){var c=this.data.locale;if(c){var l=this.combineUrlSegments(this.sitePrefix,c);t=this.combineUrlSegments(l,a)}else t=this.combineUrlSegments(this.sitePrefix,a)}r=!0===o.hideInNavigation}}return t&&(s={href:t,target:n,hideInNavigation:r}),s},SCS.combineUrlSegments=function(e,t){var s="";return"string"==typeof e&&"string"==typeof t&&e.length>0&&t.length>0&&(s="/"==e.charAt(e.length-1)&&"/"==t.charAt(0)?e+t.substring(1):"/"==e.charAt(e.length-1)&&"/"!=t.charAt(0)||"/"!=e.charAt(e.length-1)&&"/"==t.charAt(0)?e+t:e+"/"+t),s},SCS.getLocaleSiteStructure=function(){var e=SCS.cacheKeys.site?SCS.cacheKeys.site+"/":"",t=SCS.sitePrefix+e+this.data.pageLocale+"_structure.json";SCS.performance.startTimer("GET structure.json"),this.callService(t,this.processLocaleSiteStructure,this.processNoLocaleSiteStructure)},SCS.processLocaleSiteStructure=function(e,t){var s,r=!1;try{var a=JSON.parse(t);r=!!(s=a&&a.siteInfo&&a.siteInfo.base)}catch(e){}r?this.isMlsSite(s)?-1!==(s.properties&&s.properties.availableLanguages||[]).indexOf(this.data.pageLocale)?this.processSiteStructure(e,t):this.processSiteStructureRedirect(e,t):this.processSiteStructure(e,t):this.processNoLocaleSiteStructure()},SCS.processNoLocaleSiteStructure=function(){SCS.getSiteStructure(this.processSiteStructureRedirect)},SCS.processSiteStructureRedirect=function(e,t){var s=this.parseJson(t),r=s.siteInfo&&s.siteInfo.base,a=this.getDefaultLanguage(r);if(this.isMlsSite(r)&&a&&this.data.pageLocale!==a){var i=window.location.pathname,n=this.sitePrefix+i.replace(this.sitePrefix,"").replace(this.data.pageLocale,a);this.redirectToUrl(this.getRedirectUrl(n))}else delete this.data.locale,delete this.data.pageLocale,this.processSiteStructure(e,t)},SCS.getSiteStructure=function(e){var t=SCS.cacheKeys.site?SCS.cacheKeys.site+"/":"",s=SCS.sitePrefix+t+"structure.json";SCS.performance.startTimer("GET structure.json"),this.callService(s,e)},SCS.getDefaultLanguage=function(e){var t=e||this.data.siteInfo;return t&&t.properties&&t.properties.defaultLanguage},SCS.isMlsSite=function(e){return!!this.getDefaultLanguage(e)},SCS.processSiteStructure=function(e,t){SCS.performance.stopTimer("GET structure.json");var s=this.parseJson(t);this.data.structure=s;var r=s.siteInfo;r&&(this.data.siteInfo=r.base),this.produceSiteNavigationStructure()},SCS.produceSiteNavigationStructure=function(){var e=this.data.structure.base&&this.data.structure.base.pages?this.data.structure.base.pages:[];this.data.structurePages=e;for(var t=this.data.structurePages||[],s=0;s<t.length;s++){var r=t[s];this.data.navMap[r.id]=r,null==r.parentId&&(this.data.navRoot=r.id)}this.getPageData()},SCS.getSlotReuseData=function(){var e=SCS.cacheKeys.site?SCS.cacheKeys.site+"/":"",t=SCS.sitePrefix+e+"slots.json";SCS.performance.startTimer("GET slots.json"),this.callService(t,this.processSlotReuseData)},SCS.processSlotReuseData=function(e,t){SCS.performance.stopTimer("GET slots.json");try{if(!t||200!=e.status||"string"!=typeof t||t.search(/id=(["'])scsControllerBody\1/g)>=0)throw"Invalid response received while fetching slot data.";var s=this.parseJson(t);this.data.baseSlotReuseModel=this.getEffectiveSlotReuseModel(s)}catch(e){this.data.baseSlotReuseModel=null}this.getPageData()},SCS.getPageData=function(e){e=e||window.location.pathname,e=decodeURI(e);try{var t=this.getPageId(e,"");if(!t&&this.isMlsSite()&&this.data.locale&&(t=this.getPageId(e,this.data.locale)),null==t&&null!==(t=this.getErrorPageId())&&(this.data.isRenderingErrorPage=!0),null==t)return this.logError("The page could not be found in the site structure."),void this.showErrorPage(404);this.data.pageId=t,this.fetchPageData(this.data.pageId)}catch(e){}},SCS.getPageId=function(e,t){var s,r=0,a=null,i=this.sitePrefix+t+"/";if(e){if(e===this.sitePrefix.substring(0,this.sitePrefix.length-1))throw this.redirectToUrl(this.getRedirectUrl(this.sitePrefix)),"URL redirect";if(t&&e===i.substring(0,i.length-1))throw this.redirectToUrl(this.getRedirectUrl(i)),"URL redirect";e=t&&0===e.indexOf(i)?e.replace(i,""):e.replace(this.sitePrefix,"")}for(r=0;r<this.data.structurePages.length;r++){if(e===this.data.structurePages[r].pageUrl){a=this.data.structurePages[r].id;break}s=s||!!this.data.structurePages[r].isDetailPage}return null==a&&0==e.length&&null!=this.data.navRoot&&(a=this.data.navRoot),null===a&&s&&(a=this.getDetailPageId(e)),a},SCS.getDetailPageId=function(e){var t,s,r,a,i,n,o,c=null;for(t=0;t<this.data.structurePages.length;t++)if(this.data.structurePages[t].isDetailPage&&(s=this.data.structurePages[t].pageUrl,r=s.lastIndexOf("."),a=s.lastIndexOf("/"),i=r>a?r:s.length,n=r>a?s.substring(a+1,r):s.substr(a+1),s.length>0&&e.length>s.length&&s.substr(0,i)===e.substr(0,i)&&("/"===e.charAt(i)||0===n.length)&&(o=e.substring(i+1),3===(o=o.split("/")).length&&o[0].length>0&&o[1].length>0))){c=this.data.structurePages[t].id,this.data.placeholderContent={contentType:o[0],contentId:o[1]};break}return c},SCS.fetchPageData=function(){var e=SCS.cacheKeys.site?SCS.cacheKeys.site+"/":"";SCS.performance.startTimer("GET page.json");var t;this.isMlsSite()&&this.data.locale&&-1===[this.getDefaultLanguage(),"root"].indexOf(this.data.locale)?(t=SCS.sitePrefix+e+"pages/"+this.data.locale+"_"+this.data.pageId+".json",this.callService(t,this.processLocalePageData,this.processLocalePageData)):(t=SCS.sitePrefix+e+"pages/"+this.data.pageId+".json",this.callService(t,this.processPageData,this.processPageData))},SCS.processLocalePageData=function(e,t){try{if(!t||200!=e.status||"string"!=typeof t||t.search(/id=(["'])scsControllerBody\1/g)>=0)throw"Invalid response received while fetching locale page data.";var s=this.parseJson(t);this.data.localePageModel=s&&s.base||s}catch(e){this.logError("Unable to retrieve page data for locale: "+this.data.locale)}var r=SCS.cacheKeys.site?SCS.cacheKeys.site+"/":"",a=SCS.sitePrefix+r+"pages/"+this.data.pageId+".json";this.callService(a,this.processPageData,this.processPageData)},SCS.processPageData=function(e,t){SCS.performance.stopTimer("GET page.json");try{if(!t||200!=e.status||"string"!=typeof t||t.search(/id=(["'])scsControllerBody\1/g)>=0)throw"Invalid response received while fetching page data.";var s=this.parseJson(t);this.data.pageModel=this.getEffectivePageModel(s),this.data.pageLayout=this.data.pageModel.properties.pageLayout,this.data.mobileLayout=this.data.pageModel.properties.mobileLayout}catch(e){var r=this.getErrorPageId();if(this.data.isRenderingErrorPage||null===r)throw e;return this.data.isRenderingErrorPage=!0,this.data.placeholderContent=null,this.data.pageId=r,void this.fetchPageData()}this.data.localePageModel&&(this.data.pageModel=this.layerLocalePageProperties(this.data.pageModel,this.data.localePageModel)),this.getPageLayout(SCS.getDeviceInfo().isMobile&&this.data.mobileLayout||this.data.pageLayout)},SCS.layerLocalePageProperties=function(e,t){var s=e;return t.properties&&s.properties&&Object.keys(t.properties).forEach(function(e){s.properties[e]=t.properties[e]}),s},SCS.showErrorPage=function(e){var t=SCS.cacheKeys.theme?SCS.cacheKeys.theme+"/":"",s=SCS.sitePrefix+t+"_themesdelivery/"+encodeURIComponent(this.data.siteInfo.properties.themeName)+"/responsepages/"+encodeURIComponent(e)+".html";SCS.performance.startTimer("GET layout"),this.callService(s,this.processPageLayout)},SCS.redirectToUrl=function(e){window.location.replace?window.location.replace(e):window.location.href=e},SCS.getRedirectUrl=function(e){var t=e;return window.location.search&&window.location.search.length>0&&(t+=window.location.search),window.location.hash&&window.location.hash.length>0&&(t+=window.location.hash),t},SCS.getEffectivePageModel=function(e){var t=e&&e.base?e.base:{},s={};return s.properties=t.properties||{},s.slots=t.slots||{},s.componentInstances=t.componentInstances||{},s},SCS.getEffectiveSlotReuseModel=function(e){return e&&"object"==typeof e&&!Array.isArray(e)?e:{}},SCS.getErrorPageId=function(){var e=null;return this.data.siteInfo&&this.data.siteInfo.properties&&this.data.navMap&&"number"==typeof this.data.siteInfo.properties.errorPage&&this.data.navMap[this.data.siteInfo.properties.errorPage]&&(e=this.data.siteInfo.properties.errorPage),e},SCS.getDeviceInfo=SCS.getDeviceInfo||function(e){return e=e||navigator.userAgent,{isMobile:/Mobi|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)&&!/iPad/i.test(e),isIOS:/iPad|iPhone|iPod/i.test(e)&&!window.MSStream}},SCS.performance.startTimer=function(e){var t=SCS.performance.now(),s=SCS.performance.timers[e]||{};s.start=t,SCS.performance.timers[e]=s},SCS.performance.stopTimer=function(e){var t=SCS.performance.now(),s=SCS.performance.timers[e]||{};s.end=t,SCS.performance.timers[e]=s},SCS.performance.now=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},SCS.performance.startTimer("TOTAL"),SCS.performance.startTimer("CONTROLLER"),SCS.initRendering();
